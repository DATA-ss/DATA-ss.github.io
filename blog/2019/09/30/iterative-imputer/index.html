<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="../../../../../theme/css/style.min.css?fc5adb95">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="google-site-verification" content="Bk4Z5ucHLyPXqlZlj5LzANpYBBSvxqBW4E8i-Kwf-bQ" />        <meta name="msvalidate.01" content="8FF1B025212A47B5B27CC47163A042F0" />        <meta name="author" content="Kai" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="machine learning, blog, " />

<meta property="og:title" content="Iterative Imputer "/>
<meta property="og:url" content="../../../../../blog/2019/09/30/iterative-imputer/" />
<meta property="og:description" content="The IterativeImputer is an estimator that’s still experimental as of the time of writing (27 September 2019). The docstring reads: Multivariate imputer that estimates each feature from all the others. A strategy for imputing missing values by modeling each feature with missing values as a function of other features …" />
<meta property="og:site_name" content="Data Super Saiyan" />
<meta property="og:article:author" content="Kai" />
<meta property="og:article:published_time" content="2019-09-30T00:35:00-04:00" />
<meta name="twitter:title" content="Iterative Imputer ">
<meta name="twitter:description" content="The IterativeImputer is an estimator that’s still experimental as of the time of writing (27 September 2019). The docstring reads: Multivariate imputer that estimates each feature from all the others. A strategy for imputing missing values by modeling each feature with missing values as a function of other features …">

        <title>Iterative Imputer  · Data Super Saiyan
</title>
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Data Super Saiyan - Full Atom Feed" />
        <link href="/feeds/all.rss" type="application/rss+xml" rel="alternate" title="Data Super Saiyan - Full RSS Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="../../../../../"><span class=site-name>Data Super Saiyan</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       ../../../../..
                                    >Home</a>
                                </li>
                                <li ><a href="../../../../../about/">About</a></li>
                                <li ><a href="../../../../../categories">Categories</a></li>
                                <li ><a href="../../../../../tags">Tags</a></li>
                                <li ><a href="../../../../../archives">Archives</a></li>
                                <li><form class="navbar-search" action="../../../../../search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="../../../../../blog/2019/09/30/iterative-imputer/">
                Iterative&nbsp;Imputer
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <hr>
<p>The <code>IterativeImputer</code> is an estimator that&#8217;s still experimental as of the time of writing (27 September&nbsp;2019).</p>
<p>The docstring&nbsp;reads:</p>
<blockquote>
<p>Multivariate imputer that estimates each feature from all the&nbsp;others.</p>
<p>A strategy for imputing missing values by modeling each feature with missing values as a function of other features in a round-robin&nbsp;fashion.</p>
</blockquote>
<p>This means that the algorithm will take any feature with missing values and treat it like a pseudo-target, in turn using the other columns as its&#8217; features. The order of selected columns can be altered via its&#8217;&nbsp;parameters.</p>
<p>Therefore its important to note that this process would introduce some measure of correlation to the&nbsp;data.</p>
<p>Because the algorithm is using a regressor as an estimator to fill the columns with missing values, we will also want to ensure that each feature is as normally distributed as possible. This means that transformations may need to be performed to ensure optimal&nbsp;results.</p>
<hr>
<h2 id="the-important-parameters">The Important Parameters<a class="headerlink" href="#the-important-parameters" title="Permanent link">&para;</a></h2>
<blockquote>
<p>estimator:&nbsp;default=BayesianRidge()</p>
<p><code>The estimator to use at each step of the round-robin imputation. If sample_posterior is True, the estimator must support return_std in its predict method.</code></p>
</blockquote>
<p>Uses BayesianRidge by default. Can be swapped out for any other regressor such as KNeighborsRegressor or DecisionTreesRegressor among others.
Make sure to define the parameters of the regressor when calling it as an estimator for the&nbsp;algorithm.</p>
<blockquote>
<p>missing_values : int, np.nan, optional&nbsp;(default=np.nan)</p>
<p><code>The placeholder for the missing values. All occurrences of missing_values will be imputed.</code></p>
</blockquote>
<p>Use this to inform the algorithm as to how the missing values are defined in the&nbsp;dataset.</p>
<blockquote>
<p>sample_posterior : boolean,&nbsp;default=False</p>
<p><code>Whether to sample from the (Gaussian) predictive posterior of the fitted estimator for each imputation. Estimator must support return_std in its predict method if set to True. Set to True if using IterativeImputer for multiple imputations.</code></p>
</blockquote>
<p>This parameter is usually usable only when a Bayesian regressor is used as an&nbsp;estimator.</p>
<blockquote>
<p>imputation_order : str, optional (default=&#8221;ascending&#8221;)
The order in which the features will be imputed. Possible values:
- &#8220;ascending&#8221; - From features with fewest missing values to most.
- &#8220;descending&#8221; - From features with most missing values to fewest.
- &#8220;roman&#8221; - Left to right.
- &#8220;arabic&#8221; - Right to left.
- &#8220;random&#8221; - A random order for each&nbsp;round.</p>
</blockquote>
<p>Use this option to alter the order for which features get imputed first, as the round-robin nature of the algorithm means different results depending on the setting of this&nbsp;parameter.</p>
<hr>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>This blog shall serve as a proof of concept to demonstrate the usage of the <code>IterativeImputer</code> as a viable strategy for filling in missing values within any feature&nbsp;columns.</p>
<p>We will follow this procedure to test out the <code>IterativeImputer</code>:</p>
<p>1) Create a regression&nbsp;set.</p>
<p>2) Insert NaNs into regression set&#8217;s&nbsp;features.</p>
<p>3) Impute NaNs with <code>IterativeImputer</code> first, followed by the <code>SimpleImputer</code>. <code>IterativeImputer</code> will go through the <code>KNeighborsRegressor</code>, <code>LinearRegression</code> and <code>BayesianRidge</code> estimators.</p>
<p>4) Fit the regression set to an <code>ExtraTreesRegressor</code>.</p>
<p>5) Predict the target using the <code>IterativeImputer</code> and <code>SimpleImputer</code> sets and compare <span class="caps">MSE</span>&nbsp;scores.</p>
<hr>
<h2 id="1-make-a-regression-set">1) Make a Regression Set<a class="headerlink" href="#1-make-a-regression-set" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># the import packages we&#39;ll need</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span> <span class="c1"># this step is necessary because the IterativeImputer is still experimental</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span><span class="p">,</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">BayesianRidge</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">coef</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">coef</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;feature_1&quot;</span><span class="p">,</span> <span class="s2">&quot;feature_2&quot;</span><span class="p">,</span><span class="s2">&quot;feature_3&quot;</span><span class="p">,</span><span class="s2">&quot;feature_4&quot;</span><span class="p">,</span><span class="s2">&quot;feature_5&quot;</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<h2 id="2-insert-nans">2) Insert NaNs<a class="headerlink" href="#2-insert-nans" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">XX</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># fill a copy of the dataset with NaNs at random</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">XX</span><span class="o">.</span><span class="n">index</span><span class="p">))),</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">XX</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">XX</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
        <span class="n">XX</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
</code></pre></div>
</td></tr></table>
<h2 id="3-impute-nans-with-iterativeimputer-and-simpleimputer">3) Impute NaNs with <code>IterativeImputer</code> and <code>SimpleImputer</code><a class="headerlink" href="#3-impute-nans-with-iterativeimputer-and-simpleimputer" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># instantiate an instance of the IterativeImputer with the KNeighborsRegressor as an estimator</span>
<span class="n">ii_kn</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># Set verbose=2 to see the workflow of the IterativeImputer</span>
<span class="n">XX_ii_kn</span><span class="o">=</span> <span class="n">ii_kn</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Completing</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.01</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.02</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.03</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">4</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.03</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Early</span><span class="w"> </span><span class="n">stopping</span><span class="w"> </span><span class="n">criterion</span><span class="w"> </span><span class="n">reached</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># instantiate an instance of the IterativeImputer with the LinearRegression as an estimator</span>
<span class="n">ii_lin</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Set verbose=2 to see the workflow of the IterativeImputer</span>
<span class="n">XX_ii_lin</span><span class="o">=</span> <span class="n">ii_lin</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Completing</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.04</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.04</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.05</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Early</span><span class="w"> </span><span class="n">stopping</span><span class="w"> </span><span class="n">criterion</span><span class="w"> </span><span class="n">reached</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># instantiate an instance of the IterativeImputer with the BayesianRidge as an estimator</span>
<span class="n">ii_br</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">BayesianRidge</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Set verbose=2 to see the workflow of the IterativeImputer</span>
<span class="n">XX_ii_br</span><span class="o">=</span> <span class="n">ii_br</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Completing</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.01</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Ending</span><span class="w"> </span><span class="n">imputation</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mf">0.03</span><span class="w"></span>
<span class="o">[</span><span class="n">IterativeImputer</span><span class="o">]</span><span class="w"> </span><span class="n">Early</span><span class="w"> </span><span class="n">stopping</span><span class="w"> </span><span class="n">criterion</span><span class="w"> </span><span class="n">reached</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">si</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">()</span>
<span class="n">XX_si</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<h2 id="4-fit-to-a-extratreesregressor">4) Fit to a <code>ExtraTreesRegressor</code><a class="headerlink" href="#4-fit-to-a-extratreesregressor" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">et</span> <span class="o">=</span> <span class="n">ExtraTreesRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">et</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="err">ExtraTreesRegressor(bootstrap=False, criterion=&#39;mse&#39;, max_depth=None,</span>
<span class="err">                    max_features=&#39;auto&#39;, max_leaf_nodes=None,</span>
<span class="err">                    min_impurity_decrease=0.0, min_impurity_split=None,</span>
<span class="err">                    min_samples_leaf=1, min_samples_split=2,</span>
<span class="err">                    min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=None,</span>
<span class="err">                    oob_score=False, random_state=42, verbose=0,</span>
<span class="err">                    warm_start=False)</span>
</code></pre></div>
</td></tr></table>
<h2 id="5-predicting-the-targets-and-scoring">5) Predicting the Targets and Scoring<a class="headerlink" href="#5-predicting-the-targets-and-scoring" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">yhat</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE for base generated model: </span><span class="si">{</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="err">MSE for base generated model: 4.78746936230924e-26</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">yhat_ii_lin</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XX_ii_lin</span><span class="p">)</span>
<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat_ii_lin</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE for IterativeImputer with LinearRegression estimator: </span><span class="si">{</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat_ii_lin</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="err">MSE for IterativeImputer with LinearRegression estimator: 1060.1077381402583</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">yhat_ii_kn</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XX_ii_kn</span><span class="p">)</span>
<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat_ii_kn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE for IterativeImputer with KNeighborsRegressor estimator: </span><span class="si">{</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat_ii_kn</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="err">MSE for IterativeImputer with KNeighborsRegressor estimator: 855.3049715708974</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">yhat_ii_br</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XX_ii_br</span><span class="p">)</span>
<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat_ii_br</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE for IterativeImputer with BayesianRidge estimator: </span><span class="si">{</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat_ii_br</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="err">MSE for IterativeImputer with BayesianRidge estimator: 1039.619040088303</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">yhat_si</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XX_si</span><span class="p">)</span>
<span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat_si</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE for SimpleImputer: </span><span class="si">{</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yhat_si</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="err">MSE for SimpleImputer: 1040.8413193768447</span>
</code></pre></div>
</td></tr></table>
<h1 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h1>
<p>As we can see from above, the <code>Mean_Squared_Errors</code> scores demonstate that the IterativeImputer yields superior results to the SimpleImputer. The single exception being when the simple LinearRegression was used as an estimator (let&#8217;s just not use the basic LinearRegression at this&nbsp;point!).</p>
<p>We should take note that the <code>IterativeImputer</code> is still in its&#8217; developmental stage and may still be subject to bugs and errors. Nevertheless the early indications are that it&#8217;ll become another useful tool in any data scientist&#8217;s arsenal to handle missing&nbsp;values.</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
      <a href="https://twitter.com/intent/tweet?text=Iterative%C2%A0Imputer&url=/blog/2019/09/30/iterative-imputer/&hashtags=machine-learning" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
 ❄       <a href="https://www.facebook.com/sharer/sharer.php?u=/blog/2019/09/30/iterative-imputer/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
 ❄       <a href="mailto:?subject=Iterative%C2%A0Imputer&amp;body=/blog/2019/09/30/iterative-imputer/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>

            
            







            <hr/>
<section>
    <h2>Keep Reading</h2>
<ul class="related-posts-list">
<li><a href="../../../../../blog/2019/10/05/multinomial-dirichlet-distribution-with-pymc3/" title="Multinomial &amp; Dirichlet Distribution with PyMC3">Multinomial & Dirichlet Distribution with PyMC3</a></li>
<li><a href="../../../../../blog/2019/10/21/dsi-5-hackathon-the-youtube-virality-prophet/" title="DSI 5 Hackathon - The (YouTube) Virality Prophet">DSI 5 Hackathon - The (YouTube) Virality Prophet</a></li>
<li><a href="../../../../../blog/2019/11/12/point-forward-the-job-description-hacker/" title="Point Forward: The Job Description Hacker">Point Forward: The Job Description Hacker</a></li>
<li><a href="../../../../../blog/2019/12/01/how-to-run-your-nltk-pythonic-app-on-heroku/" title="How to Run Your NLTK Pythonic App on Heroku">How to Run Your NLTK Pythonic App on Heroku</a></li>
<li><a href="../../../../../blog/2020/02/20/takeaways-from-amazons-machine-learning-use-case-call-center/" title="Takeaways from Amazon’s Machine Learning Use Case: Call Center">Takeaways from Amazon’s Machine Learning Use Case: Call Center</a></li>
</ul>
<hr />
</section>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="../../../../../blog/2019/09/30/missing-indicator/" title="Previous: Missing Indicator">Missing Indicator</a></li>
                <li class="next-article"><a href="../../../../../blog/2019/10/05/multinomial-dirichlet-distribution-with-pymc3/" title="Next: Multinomial &amp; Dirichlet Distribution with PyMC3">Multinomial & Dirichlet Distribution with PyMC3</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~5 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2019-09-30T00:35:00-04:00">Mon 30 September 2019</time>
            <h4>Category</h4>
            <a class="category-link" href="../../../../../categories#blog-ref">blog</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="../../../../../tags#machine-learning-ref">machine learning
                    <span class="superscript">8</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="http://twitter.com/iranzop" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Twitter" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1da1f3"/><path fill="#fff" d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
    </a>
    <a href="http://github.com/iranzo" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/iranzo/" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>

    <div>
        <span class="site-name">Data Super Saiyan</span> - Where we go even further beyond!
    </div>


    <span class="site-name">Data Super Saiyan</span>  is a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for sites to earn advertising fees by advertising and linking to Amazon.com.
    <div id="amzn-assoc-ad-23824450-ef77-4537-9259-8590465886f1">
    </div>
    <script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=23824450-ef77-4537-9259-8590465886f1">
    </script>

    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="../../../../../theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>